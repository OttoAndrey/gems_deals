# Тестовое задание "Сделки по камням"

REST-Api для обработки .cvs файлов и вывода статистики.


## Условие задания

1. Данные хранятся в реляционной БД, взаимодействие с ней
осуществляется посредством django ORM.
2. Ранее загруженные версии файла deals.csv не должны влиять на
результат обработки новых.
3. Эндпоинты соответствуют спецификации:

**Выдача обработанных данных**
####Метод: GET

В ответе содержится поле “response” со списком из 5 клиентов,
потративших наибольшую сумму за весь период.
Каждый клиент описывается следующими полями:
* username - логин клиента;
* spent_money - сумма потраченных средств за весь период;
* gems - список из названий камней, которые купили как
минимум двое из списка &quot;5 клиентов, потративших
наибольшую сумму за весь период&quot;, и данный клиент
является одним из этих покупателей.
  
**Загрузка файла для обработки**
####Метод: POST

Аргументы:
* deals: файл, содержащий историю сделок.

Ответ:
* Status: OK - файл был обработан без ошибок;
* Status: Error, Desc: &lt;Описание ошибки&gt; - в процессе
обработки файла произошла ошибка.

4. Приложение должно быть контейнирезировано при помощи docker;
5. Проект не использует глобальных зависимостей за исключением:
python, docker, docker-compose;
6. Readme проекта описывает весь процесс установки, запуска и
работы с сервисом;
7. Требования к фронтенду не предъявляются, интерфейс
взаимодействия — RestFull API;
8. Проект запускается одной командой.


## Запуск

Скачать репозиторий.

Перейти в папку с проектом.

Собрать и запустить проект
`docker-compose up`

Провести миграции
`docker-compose run server python3.9 manage.py migrate`


## Работа с сервисом

По адресу [http://0.0.0.0:8000/deal/](http://0.0.0.0:8000/deal/) сделать POST запрос с
аргументом `deals`, который содержит `.csv` файл. 

Поля файла:
`customer,item,total,quantity,date`

По тому же адресу сделать GET запрос — вернется список из 5 самых покупательных клиентов.
